<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<title>BQNsweeper</title>
<style>
@font-face{
  font-family: BQN386;
  src: url(BQN386.subset.woff2) format('woff2');
}
pre,code,textarea {
  font-family: BQN386, monospace;
}
textarea, button {
  font-size: 1.2rem;
  line-height: 1.4;
}
#grid > button {
  width: 30px;
  height: 30px;
  padding: 0;
  vertical-align: bottom;
}
input {
  width: 3em;
}
</style>
</head>

<body>
<div id="try_again">
  <h1 id="ending_text">BQNsweeper</h1>
  <button onClick="restartGame()">Generate</button>
  <input id="h" type="number" value="8">×<input id="v" type="number" value="8">,
  <input id="m" type="number" value="10"> mines
  <h3><span id="min">0</span>:<span id="sec">00</span></h3>
  <hr/>
</div>
<div id="grid"></div>
<hr/>

<h2>Source code</h2>
<pre id="src"></pre>

See page source for the javascript implementing this UI on top of the BQN logic.
<br>
The BQNsweeper code is CC0 licensed. It runs on bqn.js by Marshall Lochbaum, ISC license. 

<script src="bqn.js"></script>
<script>
  const src =
`Grid ← {𝕩⥊(↕×´𝕩)∊𝕨•rand.Deal ×´𝕩}
Pad ← {0∾˘⍉⌽𝕩}⍟4
Adjacent ← +´∘⥊⎉2 3‿3↕Pad
Spread ← {⍉⌽𝕩∨»𝕩}⍟4
Flood ← ∧⟜Spread⍟{+´≢𝕩}

Game ← {count 𝕊 size:
  mines ← count Grid size
  adj ← Adjacent mines
  seen ← size⥊0
  Guess ⇐ {𝕊 x‿y:
    g ← 1⌾(y‿x⊸⊑)size⥊0
    seen ∨↩(0=adj)Spread∘Flood⍟(0=+´⥊g×adj) g
  }
  Render ⇐ {𝕊: ⊑⟜".x 12345678"¨seen×seen+(¬mines)×1+adj}
  Result ⇐ {𝕊: (seen≡¬mines) - ∨´⥊seen∧mines}
}`

  document.getElementById("src").innerText = src
  let time;
  let min = 0
  let sec = 0

  function setTimeToDom() {
    document.getElementById("min").innerText = min
    document.getElementById("sec").innerText = String(sec).padStart(2, '0')
  }

  function updateTime() {
    sec += 1
    if (sec >= 60) {
        min += 1
    }
    sec %= 60
    setTimeToDom()
  }

  function restartGame() {
    const h = parseInt(document.getElementById("h").value)
    const v = parseInt(document.getElementById("v").value)
    const m = parseInt(document.getElementById("m").value)

    if(time) {
      min = 0;
      sec = 0;
      clearInterval(time);
    }
    time = window.setInterval(updateTime, 1000)
    setTimeToDom();

    const Game = run.apply(null, compile(src))
    const obj = Game(list([v,h]), m)
    const ns = nsget(obj)
    const render = ns("render")
    const result = ns("result")
    const guess = ns("guess")

    const grid = document.getElementById("grid")
    while(grid.firstChild) grid.removeChild(grid.firstChild)
    document.getElementById("ending_text").innerText = "BQNsweeper"

    let flags = new Array(h*v)
    flags.fill(false);

    for (let i=0; i<v; i++) {
      for (let j=0; j<h; j++) {
        const btn = document.createElement("button")
        const idx = i*h+j
        btn.id = "btn-" + idx
        btn.innerText = "."
        btn.addEventListener("mouseup", e => {
          if (e.button == 2) {
            flags[idx] = !flags[idx]
            update()
          } else if (!flags[idx]) {
            guess(list([j,i]))
            update()
          }
        })
        btn.addEventListener("contextmenu", e => e.preventDefault())
        grid.appendChild(btn)
      }
      grid.appendChild(document.createElement("br"))
    }

    function char(flag, value) {
      if (flag) return "🚩"
      if (value == "x") return "💣"
      return value
    }

    function update() {
      const g = render()
      const res = result()
      const gameOver = res !== 0
      for (let i=0; i<v*h; i++) {
        const btn = document.getElementById("btn-" + i)
        btn.innerText = char(flags[i], g[i])
        btn.disabled = gameOver
      }
      const text = res === 1 ? "You win" : "You lose"
      if (gameOver) {
        document.getElementById("ending_text").innerText = text
        clearInterval(time)
      }
    }
  }

  window.onLoad = restartGame()
</script>

</body>
</html>
